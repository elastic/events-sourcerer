MAX_FAILURES: 50 (tests)
STACK_VERSIONS: custom
TESTS: tests/test_emitter_queries.py tests/test_emitter_rules.py

======================================== - 0 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 418 398 368 337 307 274 246 231 226 215 195 189 160 109 78 63 8 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1009.966s

FAILED (errors=1)
======================================== - 1 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 427 392 368 345 310 273 241 236 214 214 212 206 183 142 103 74 31 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1040.945s

FAILED (errors=1)
======================================== - 2 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 455 454 434 413 411 399 382 372 354 333 313 292 292 273 256 247 239 239 233 215 192 188 158 138 128 106 77 52 32 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1036.835s

FAILED (errors=1)
======================================== - 3 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 483 463 443 422 421 401 399 379 358 353 338 318 298 269 242 231 215 209 196 169 169 141 112 92 82 51 21 21 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1040.461s

FAILED (errors=1)
======================================== - 4 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 483 482 462 461 440 420 418 397 377 376 356 325 325 294 266 265 239 230 217 198 192 173 153 124 114 94 67 38 31 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1031.877s

FAILED (errors=1)
======================================== - 5 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 ERROR

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

======================================================================
ERROR: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/test_emitter_rules.py", line 254, in test_rules
    pending = self.load_rules_and_docs(rules, asts)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 405, in load_rules_and_docs
    for rule, (rule_id, created_rule) in zip(chunk, ret):
  File "/Users/cavok/elastic/geneve.git/geneve/utils/kibana.py", line 123, in create_detection_engine_rules
    res.raise_for_status()
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 503 Server Error: Service Unavailable for url: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443/api/detection_engine/rules/_bulk_create

----------------------------------------------------------------------
Ran 13 tests in 609.499s

FAILED (errors=2)
======================================== - 6 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
setUpClass (tests.test_emitter_queries.TestSignalsQueries) ... ERROR
/usr/local/Cellar/python@3.11/3.11.7/Frameworks/Python.framework/Versions/3.11/lib/python3.11/unittest/suite.py:176: ResourceWarning: unclosed <ssl.SSLSocket fd=8, family=2, type=1, proto=0, laddr=('10.1.2.41', 61454), raddr=('54.73.172.8', 443)>
  self._createClassOrModuleLevelException(result, e,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 531 511 510 492 472 462 442 422 420 399 369 368 338 307 278 278 250 233 221 201 191 174 157 127 117 97 65 45 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 ERROR

======================================================================
ERROR: setUpClass (tests.test_emitter_queries.TestSignalsQueries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 244, in setUpClass
    stack.connect()
  File "/Users/cavok/elastic/geneve.git/geneve/stack/prober_elastic.py", line 120, in connect
    kb.status()
  File "/Users/cavok/elastic/geneve.git/geneve/utils/kibana.py", line 87, in status
    res.raise_for_status()
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 503 Server Error: Service Unavailable for url: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443/api/status

======================================================================
ERROR: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/test_emitter_rules.py", line 256, in test_rules
    self.check_signals(rules, pending)
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 600, in check_signals
    signals = self.wait_for_signals(rules)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 523, in wait_for_signals
    signals = self.get_signals_per_rule(rules)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 507, in get_signals_per_rule
    branch_count = get_rule_test_data(rules, bucket["key"])["branch_count"]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 128, in get_rule_test_data
    return get_rule_by_id(rules, rule_id)[".test_private"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 124, in get_rule_by_id
    raise KeyError(f"cannot to find rule by id: {rule_id}")
KeyError: 'cannot to find rule by id: f7834036-47ce-4df6-80d8-aee31b88a043'

----------------------------------------------------------------------
Ran 12 tests in 917.529s

FAILED (errors=2)
======================================== - 7 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 427 407 388 366 325 299 276 248 239 220 212 210 195 184 159 134 106 85 68 53 30 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1023.969s

FAILED (errors=1)
======================================== - 8 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 592 590 588 584 583 583 582 561 531 496 479 455 416 395 355 327 273 233 214 188 157 142 124 87 62 15 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1124.593s

FAILED (errors=1)
======================================== - 9 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 419 391 379 358 348 338 318 317 296 267 257 239 222 213 203 171 162 142 123 103 75 54 42 22 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1030.389s

FAILED (errors=1)
======================================== - 10 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 431 394 367 338 302 272 240 228 210 197 187 161 130 105 77 43 10 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1066.333s

FAILED (errors=1)
======================================== - 11 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 430 396 367 331 309 274 245 229 213 213 200 175 145 115 91 57 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1018.087s

FAILED (errors=1)
======================================== - 12 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 481 460 440 440 418 399 389 379 359 339 328 318 288 259 233 233 218 200 181 160 160 147 132 120 95 67 46 27 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1027.732s

FAILED (errors=1)
======================================== - 13 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 421 396 362 340 299 274 239 231 222 202 185 169 158 151 133 111 93 65 46 25 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1024.459s

FAILED (errors=1)
======================================== - 14 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 463 443 442 421 401 400 379 378 357 337 307 306 276 248 248 238 229 213 195 178 161 132 106 78 68 38 8 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1017.322s

FAILED (errors=1)
======================================== - 15 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 490 478 458 438 437 417 415 396 374 354 334 323 293 266 242 239 230 215 205 184 163 163 151 143 113 93 84 53 33 22 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1013.875s

FAILED (errors=1)
======================================== - 16 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 426 398 369 334 294 267 249 228 224 222 202 179 146 118 69 40 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1028.274s

FAILED (errors=1)
======================================== - 17 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 458 457 437 436 414 394 393 372 353 323 322 292 291 262 246 227 227 211 204 184 164 134 134 105 84 74 45 32 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1021.863s

FAILED (errors=1)
======================================== - 18 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 432 393 374 342 305 268 241 226 219 217 208 199 178 122 87 62 30 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1024.711s

FAILED (errors=1)
======================================== - 19 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 456 436 435 415 393 382 373 352 338 331 311 282 281 254 226 221 215 207 188 170 140 130 111 100 61 61 30 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1035.586s

FAILED (errors=1)
======================================== - 20 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 491 481 461 440 439 419 417 397 377 375 354 334 333 313 284 283 255 240 232 217 209 192 167 162 131 111 102 72 62 41 21 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1026.744s

FAILED (errors=1)
======================================== - 21 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 425 393 367 337 306 278 253 236 236 215 190 159 151 140 113 70 41 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1033.731s

FAILED (errors=1)
======================================== - 22 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 451 421 389 367 341 303 267 244 228 218 200 190 173 156 146 133 115 89 68 44 18 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1015.606s

FAILED (errors=1)
======================================== - 23 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 426 394 372 343 308 273 248 231 216 216 216 207 183 140 103 77 43 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1030.560s

FAILED (errors=1)
======================================== - 24 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 466 465 445 424 424 404 395 381 361 361 340 320 301 281 281 270 261 252 236 229 219 219 205 187 168 167 147 136 125 112 105 95 86 66 46 45 26 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1033.603s

FAILED (errors=1)
======================================== - 25 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 494 478 474 453 433 413 411 392 370 350 340 319 290 262 261 234 226 219 209 182 162 132 110 102 74 54 34 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1027.299s

FAILED (errors=1)
======================================== - 26 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 482 462 442 442 420 401 389 379 358 348 338 317 287 287 258 232 224 221 215 203 176 166 136 135 114 96 76 48 18 17 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1033.531s

FAILED (errors=1)
======================================== - 27 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 427 402 370 341 315 271 248 238 233 216 193 178 148 104 80 56 25 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1026.252s

FAILED (errors=1)
======================================== - 28 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 422 399 376 353 350 331 328 309 292 281 258 239 224 224 215 203 185 182 158 138 123 105 91 88 79 75 68 33 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1018.518s

FAILED (errors=1)
======================================== - 29 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 423 402 368 347 322 289 261 242 223 218 218 216 203 189 169 140 119 98 76 57 26 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1023.547s

FAILED (errors=1)
======================================== - 30 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 474 464 444 444 422 402 391 382 361 341 341 310 281 254 254 236 217 205 196 187 160 140 111 98 82 56 34 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1037.976s

FAILED (errors=1)
======================================== - 31 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 581 579 575 571 571 571 571 571 571 571 571 571 571 571 550 514 471 436 386 351 303 255 227 190 165 156 134 112 92 48 24 24 21 14 9 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1140.124s

FAILED (errors=1)
======================================== - 32 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 404 394 374 363 352 332 312 311 291 272 271 242 237 220 211 193 179 165 135 135 105 85 75 46 16 15 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1045.715s

FAILED (errors=1)
======================================== - 33 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 421 391 352 322 289 263 236 225 207 186 174 143 124 116 93 76 39 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1070.827s

FAILED (errors=1)
======================================== - 34 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 433 402 380 340 311 287 258 231 217 197 180 163 131 109 92 72 52 8 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790
  test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [Failed rules] ... FAIL
  test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [tests/reports/alerts_from_rules-8.13.md] ... FAIL

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

======================================================================
FAIL: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [Failed rules]
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 596, in assertSignals
    self.assertEqual(len(rule_ids), value, msg=msg)
AssertionError: 2 != 1

======================================================================
FAIL: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [tests/reports/alerts_from_rules-8.13.md]
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 166, in assertReportUnchanged
    assertIdenticalFiles(tc, filename, new_filename)
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 151, in assertIdenticalFiles
    tc.assertEqual(first_hash, second_hash, msg=msg)
AssertionError: '7b2bda3a13ca003e80a70f38a8b4bc0dc0b96475a897ddd83fec175f50b844e9' != 'b28157e4f222c1fa73cb1e63a0253c10477a037c6560447ec4a67e0d48946cbc'
- 7b2bda3a13ca003e80a70f38a8b4bc0dc0b96475a897ddd83fec175f50b844e9
+ b28157e4f222c1fa73cb1e63a0253c10477a037c6560447ec4a67e0d48946cbc


----------------------------------------------------------------------
Ran 13 tests in 1026.507s

FAILED (failures=2, errors=1)
======================================== - 35 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 476 456 435 414 412 393 373 373 352 322 292 291 261 244 235 233 201 197 178 174 158 130 108 92 81 52 30 21 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790
  test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [tests/reports/alerts_from_rules-8.13.md] ... FAIL

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

======================================================================
FAIL: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) [tests/reports/alerts_from_rules-8.13.md]
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 166, in assertReportUnchanged
    assertIdenticalFiles(tc, filename, new_filename)
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 151, in assertIdenticalFiles
    tc.assertEqual(first_hash, second_hash, msg=msg)
AssertionError: 'b28157e4f222c1fa73cb1e63a0253c10477a037c6560447ec4a67e0d48946cbc' != '7b2bda3a13ca003e80a70f38a8b4bc0dc0b96475a897ddd83fec175f50b844e9'
- b28157e4f222c1fa73cb1e63a0253c10477a037c6560447ec4a67e0d48946cbc
+ 7b2bda3a13ca003e80a70f38a8b4bc0dc0b96475a897ddd83fec175f50b844e9


----------------------------------------------------------------------
Ran 13 tests in 1027.760s

FAILED (failures=1, errors=1)
======================================== - 36 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 451 421 391 372 341 303 275 249 242 233 229 215 203 195 175 151 123 105 72 43 20 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1031.305s

FAILED (errors=1)
======================================== - 37 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 ERROR

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

======================================================================
ERROR: test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/test_emitter_rules.py", line 254, in test_rules
    pending = self.load_rules_and_docs(rules, asts)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 405, in load_rules_and_docs
    for rule, (rule_id, created_rule) in zip(chunk, ret):
  File "/Users/cavok/elastic/geneve.git/geneve/utils/kibana.py", line 126, in create_detection_engine_rules
    raise ValueError(f"{rule['error']['message']}: {rules[i]}")
ValueError: socket hang up - Local: 10.2.86.65:34160, Remote: 10.253.111.8:443: {'rule_id': 'c3f5e1d8-910e-43b4-8d44-d748e498ca86', 'risk_score': 73, 'description': 'Identifies an outbound network connection by JAVA to LDAP, RMI or DNS standard ports followed by a suspicious JAVA child processes. This may indicate an attempt to exploit a JAVA/NDI (Java Naming and Directory Interface) injection vulnerability.', 'name': 'Geneve: Potential JAVA/JNDI Exploitation Attempt', 'index': ['geneve-ut-561'], 'interval': '180s', 'from': 'now-2h', 'severity': 'high', 'type': 'eql', 'query': 'sequence by host.id with maxspan=1m\n [network where event.action == "connection_attempted" and\n  process.name : "java" and\n  /*\n     outbound connection attempt to\n     LDAP, RMI or DNS standard ports\n     by JAVA process\n   */\n  destination.port in (1389, 389, 1099, 53, 5353)] by process.pid\n [process where event.type == "start" and\n\n  /* Suspicious JAVA child process */\n  process.parent.name : "java" and\n   process.name : ("sh",\n                   "bash",\n                   "dash",\n                   "ksh",\n                   "tcsh",\n                   "zsh",\n                   "curl",\n                   "perl*",\n                   "python*",\n                   "ruby*",\n                   "php*",\n                   "wget")] by process.parent.pid\n', 'language': 'eql', 'tags': ['Geneve', 'Domain: Endpoint', 'OS: Linux', 'OS: macOS', 'Use Case: Threat Detection', 'Tactic: Execution', 'Use Case: Vulnerability', 'Data Source: Elastic Defend'], 'max_signals': 1000, 'enabled': True}

----------------------------------------------------------------------
Ran 13 tests in 617.258s

FAILED (errors=2)
======================================== - 38 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ...
  Deleting any unit-test indices: 58 0
  Loading documents: 218 0
  Loading rules: 58 8 0
  Waiting for rules execution: 58 47 8 0
  Waiting for signals generation: 90 88 88 88 88 88 88 88 88 88 88 88 88 88 88 88 88 79 64 30 0 ok
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 519 518 497 481 461 441 420 419 398 378 378 357 337 336 315 295 295 275 257 248 248 239 230 222 217 206 186 167 167 146 127 127 106 96 86 67 46 46 25 16 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

----------------------------------------------------------------------
Ran 13 tests in 1136.977s

OK
======================================== - 39 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 424 385 369 330 295 272 240 231 218 203 184 163 139 122 104 86 54 13 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1026.871s

FAILED (errors=1)
======================================== - 40 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 469 460 447 427 426 404 403 383 362 352 341 311 310 281 254 242 237 228 215 201 173 172 143 113 100 80 60 50 20 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1021.527s

FAILED (errors=1)
======================================== - 41 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 486 467 446 445 425 424 402 382 381 361 357 330 299 279 270 243 226 220 211 192 170 149 128 105 73 72 43 13 12 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1029.794s

FAILED (errors=1)
======================================== - 42 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 487 476 468 447 427 407 404 384 363 353 343 312 283 255 245 239 214 204 178 150 150 110 101 81 71 25 15 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1017.201s

FAILED (errors=1)
======================================== - 43 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 500 480 460 459 439 438 417 397 394 376 347 317 287 287 260 251 241 221 221 202 175 155 124 124 96 95 64 34 33 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1031.526s

FAILED (errors=1)
======================================== - 44 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 484 464 463 442 422 421 401 399 380 360 340 339 309 278 251 234 222 222 209 197 175 145 125 103 85 61 51 30 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1035.424s

FAILED (errors=1)
======================================== - 45 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 492 485 464 444 444 423 402 391 380 349 319 309 289 261 243 237 222 212 203 175 154 126 104 84 75 46 15 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1020.788s

FAILED (errors=1)
======================================== - 46 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 501 484 474 453 441 433 413 410 391 370 340 339 309 294 280 261 260 234 233 215 197 175 155 126 99 89 71 41 24 10 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1022.199s

FAILED (errors=1)
======================================== - 47 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 502 484 474 464 444 424 423 403 401 380 350 330 319 289 260 250 234 216 208 186 164 164 140 136 107 105 76 56 46 16 15 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1027.556s

FAILED (errors=1)
======================================== - 48 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 443 412 382 352 327 298 260 239 226 217 215 200 192 169 135 119 95 76 46 21 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1025.204s

FAILED (errors=1)
======================================== - 49 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 469 449 448 428 408 405 386 366 366 345 330 325 295 267 249 240 228 209 197 177 176 148 131 109 88 59 48 18 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1029.550s

FAILED (errors=1)
======================================== - 50 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 486 466 465 444 424 423 402 402 381 360 350 318 283 283 255 231 215 206 206 188 162 134 132 103 75 75 26 26 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1016.871s

FAILED (errors=1)
======================================== - 51 - ========================================
TEST_ELASTICSEARCH_URL: https://geneve-test-c03023.es.eu-west-1.aws.qa.elastic.cloud:443
TEST_KIBANA_URL: https://geneve-test-c03023.kb.eu-west-1.aws.qa.elastic.cloud:443
TEST_STACK_VERSION: 8.13.0
TEST_SCHEMA_URI: ./etc/ecs-v8.11.0.tar.gz
TEST_DETECTION_RULES_URI: https://epr.elastic.co/search?package=security_detection_engine&kibana.version=8.13.0
test_cardinality (tests.test_emitter_queries.TestQueries.test_cardinality) ... ok
test_exceptions (tests.test_emitter_queries.TestQueries.test_exceptions) ... ok
test_len (tests.test_emitter_queries.TestQueries.test_len) ... ok
test_mappings (tests.test_emitter_queries.TestQueries.test_mappings) ... ok
test_mono_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_mono_doc) ... ok
test_mono_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_mono_branch_multi_doc) ... ok
test_multi_branch_mono_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_mono_doc) ... ok
test_multi_branch_multi_doc (tests.test_emitter_queries.TestQueries.test_multi_branch_multi_doc) ... ok
test_unchanged (tests.test_emitter_queries.TestQueries.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries) ... ERROR
test_rules_collection (tests.test_emitter_rules.TestRules.test_rules_collection) ... ok
test_unchanged (tests.test_emitter_rules.TestRules.test_unchanged) ... ok
ES: 8.11.0 2023-10-31 00:00:00 00000000 (serverless)
KB: 8.13.0 2024-01-14 16:13:48 8cc7cadf
test_rules (tests.test_emitter_rules.TestSignalsRules.test_rules) ...
  Deleting any unit-test indices: 873 773 673 573 473 373 273 173 73 0
  Loading documents: 173210 160610 148210 135810 123410 111010 98610 86210 73810 61410 49010 36610 24210 11810 0
  Loading rules: 873 823 773 723 673 623 573 523 473 423 373 323 273 223 173 123 73 23 0
  Waiting for rules execution: 713 444 404 376 353 328 295 263 245 238 231 219 208 162 142 105 81 65 48 22 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  Waiting for signals generation: 32667 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 12790 ok

======================================================================
ERROR: test_queries (tests.test_emitter_queries.TestSignalsQueries.test_queries)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/cavok/elastic/geneve.git/tests/utils.py", line 292, in setUp
    self.es.delete_by_query(**kwargs)
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/__init__.py", line 1319, in delete_by_query
    return self.perform_request(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cavok/Library/Python/3.11/lib/python/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionTimeout: Connection timed out

----------------------------------------------------------------------
Ran 13 tests in 1035.393s

FAILED (errors=1)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> - 51 - <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
